#include <stdlib.h>
#include <stdio.h>
#include <string.h>

int main(int argc, char *argv[]) {
  long lVar2;
  char *local_68;
  char *local_60;
  unsigned char local_58;
  unsigned char local_50;
  unsigned char  local_48;
  int local_40;
  int local_3c;
  int local_38;
  int local_34;
  void *local_30;
  size_t local_28;
  FILE *local_20;
  int local_18;
  int local_14;
  char *local_10;

  if(argc != 2){
    printf("./get_malware <image>");
    exit(-1);
  }

  local_20 = fopen(argv[1],"r");
  fseek(local_20,0,2);
  lVar2 = ftell(local_20);
  local_28 = lVar2 + 1;
  fseek(local_20,0,0);
  local_30 = malloc(local_28);
  if (local_30 != (void *)0x0) {
    fread(local_30,local_28,1,local_20);
    local_10 = (char *)0x0;
    local_14 = 0;
    while (((ulong)(long)local_14 < local_28 - 8 &&
            (local_10 = strstr((char *)((long)local_30 + (long)local_14),"DEADBEAF"),
            local_10 == (char *)0x0))) {
      local_14 = local_14 + 1;
    }
	  fseek(local_20,local_14,0);
    if (local_10 != (char *)0x0) {
      local_34 = ((int)local_10 - (int)local_30) + 8;
      fseek(local_20,local_34,0);
      for (local_18 = local_34; (ulong)(long)local_18 < local_28; local_18 = local_18 + 1) {
        printf("%c",*(char *)((long)local_30 + (long)local_18) ^ 0x58);
      }
    }
  }
}